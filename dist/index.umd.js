(function(a,p){typeof exports=="object"&&typeof module<"u"?p(exports):typeof define=="function"&&define.amd?define(["exports"],p):(a=typeof globalThis<"u"?globalThis:a||self,p(a.PurifyHTML={}))})(this,function(a){"use strict";const p=()=>{if(globalThis.DOMParser===void 0)throw`globalThis.DOMParser is not defined!
It seems that you use purify-html in node environment.
For node environment you need to add HTML parser by yourself.
See https://github.com/oleksandr-dukhovnyy/purify-html?tab=readme-ov-file#node-js for details.`;const e=new DOMParser().parseFromString("","text/html").querySelector("body");return{parse(t){return e.innerHTML=t,e},stringify(t){return t.innerHTML}}},O=(e,t)=>e.setAttribute(t,""),m=e=>{if("childNodes"in e)for(let t=e.childNodes.length-1;t>0;t--)e.childNodes[t].nodeType===8&&e.childNodes[t].remove();else return!1},j=(()=>{const e=(t,r=0)=>{if(t._d=r,t.children.length)[...t.children].forEach(i=>e(i,r+1));else return r};return t=>(e(t),[...t.querySelectorAll("*")].sort((r,i)=>i._d-r._d).map(r=>(delete r._d,r)))})(),T=e=>{const t=[];return Object.prototype.hasOwnProperty.call(e,"attributes")||(e.attributes=[]),e.attributes.forEach(r=>{switch(typeof r){case"string":t.push({name:r});break;case"object":t.push(r);break}}),e.attributes=t,e},u=e=>{try{return new URL(e)}catch{return null}},v=e=>{if(typeof e=="string")return e;if(Array.isArray(e))return e.map(t=>v(t));if(typeof e=="object"&&e!==null){const t={};for(const r in e)e[r]instanceof RegExp?t[r]=e[r]:typeof e[r]=="object"?t[r]=v(e[r]):t[r]=e[r];return t}return e},L=e=>e.map(v),b={"%correct-link%"(e){return console.warn("Default presets is deprecated and will be removed in 2.0.0. See release notes for v1.5.4"),{remove:u(e)===null}},"%http-link%"(e){console.warn("Default presets is deprecated and will be removed in 2.0.0. See release notes for v1.5.4");const t=u(e);return{remove:t===null||t.protocol!=="http:"}},"%https-link%"(e){console.warn("Default presets is deprecated and will be removed in 2.0.0. See release notes for v1.5.4");const t=u(e);return{remove:t===null||t.protocol!=="https:"}},"%ftp-link%"(e){console.warn("Default presets is deprecated and will be removed in 2.0.0. See release notes for v1.5.4");const t=u(e);return{remove:t===null||t.protocol!=="ftp:"}},"%https-link-without-search-params%"(e){console.warn("Default presets is deprecated and will be removed in 2.0.0. See release notes for v1.5.4");const t=u(e);return{remove:t===null||t.search!==""||t.protocol!=="https:"}},"%http-link-without-search-params%"(e){console.warn("Default presets is deprecated and will be removed in 2.0.0. See release notes for v1.5.4");const t=u(e);return{remove:t===null||t.search!==""||t.protocol!=="http:"}},"%same-origin%"(e){console.warn("Default presets is deprecated and will be removed in 2.0.0. See release notes for v1.5.4");const t=u(e);return{remove:t===null||globalThis.location.origin!==t.origin}}};let f;class y{removeComments=!0;allowedTags={};whiteList;constructor(t=[]){f||(f=p()),this.allowedTags=L(t).reduce((r,i)=>{switch(typeof i){case"string":{i==="#comments"?this.removeComments=!1:r[i]=Object.assign(r[i]||{},{});break}case"object":r[i.name]=Object.assign(r[i.name]||{},T(i))}return r},{}),this.whiteList=Object.keys(this.allowedTags),this.sanitize.bind(this)}sanitize(t){const r=f.parse(t);return this.removeComments&&m(r),j(r).forEach(l=>{const w=l.tagName.toLowerCase();if(this.whiteList.includes(w)){const h=this.allowedTags[w];if(this.removeComments&&h.dontRemoveComments!==!0&&m(l),Object.prototype.hasOwnProperty.call(h,"attributes")&&h.attributes.length>0){const d=[],s=[];for(let c=0;c<l.attributes.length;c++){const n=l.attributes[c],o=h.attributes.find(g=>g.name===n.name);o?Object.prototype.hasOwnProperty.call(o,"value")&&(typeof o.value=="string"?n.value!==o.value&&s.push(n.name):typeof o.value=="function"?o.value(n.value)||s.push(n.name):o.value instanceof RegExp?o.value.test(n.value)||s.push(n.name):Array.isArray(o.value)?o.value.includes(n.value)||s.push(n.name):typeof o.value=="object"&&Object.prototype.hasOwnProperty.call(o.value,"preset")&&Object.prototype.hasOwnProperty.call(b,o.value.preset)?b[o.value.preset](n.value).remove&&s.push(n.name):s.push(n.name)):d.push(n.name)}d.forEach(c=>l.removeAttribute(c)),s.forEach(c=>O(l,c))}else{const d=[];for(let s=0;s<l.attributes.length;s++)d.push(l.attributes[s].name);d.forEach(s=>l.removeAttribute(s))}}else this.removeComments&&m(l),l.insertAdjacentHTML("afterend",l.innerHTML),l.remove()}),f.stringify(r)}toHTMLEntities(t){return t.split("").map(r=>`&#${r.charCodeAt(0)};`).join("")}}const k=e=>e?Object.prototype.hasOwnProperty.call(e,"parse")?Object.prototype.hasOwnProperty.call(e,"stringify")?(f=e,1):(console.error('cannot to find method "stringify" in custom parser!',e),0):(console.error('cannot to find method "parse" in custom parser!',e),0):(console.error("customParser is null!"),0);a.default=y,a.sanitizer=y,a.setParser=k,Object.defineProperties(a,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
//# sourceMappingURL=index.umd.js.map
